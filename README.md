# TorsoSharp

The `Torso.exe` is a .NET program is responsible for running unit tests utilizing Muvee Technologies Pte Ltd's Windows SDK. "Mufat" stands for "Muvee Framework for Automated Testing", and was originally written by Ali-Akber Saifee in C++ (Check out the introduction video presented at GTAC 2007: https://www.youtube.com/watch?v=ViM4WPGAKjI).

The `TorsoSharp.exe` is a redesign of the Torso ported to .NET, which grants some bonus features such as .NET COM interop, much cleaner code and CLR scripting language support, e.g. Python via the IronPython scripting engine.

## Details

The TorsoSharp project supports running tests written in either Python (`IronTorso`) or with the original Mufat testing language (`Torso`).

### Torso

The `Torso` is a simplified compiler and test runner that loads unit tests written in Mufat, parses it into a series of API instructions, and runs the unit test via .NET COM interop to collect the final test results.

### IronTorso

The `IronTorso` is a port of the Torso that allows for more complex yet easier-to-write unit tests by supporting unit tests written in Python. It first initializes the Python unit testing environment in the embedded IronPython scripting engine (see `IronBindings` below), and then proceeds to collect the test results generated by the unit test code.

### IronBindings

A collection of platform-independent Python binding code that dynamically rewrites Python scripts into a suite of unit tests, whereby each call into the Muvee SDK becomes a unit test. See the `IronBindings` project for details.

## Sample

Here's a sample Python snippet that will import a Muvee style, import some media, analyse and make the video, and then play the preview in a 320x240 window.

    from muvee import AddSourceImage, AddSourceMusic, AddSourceVideo, MakeFlags, \
        PreviewTillDone, SetActiveMVStyle, ThreadedMakeTillDone, TimelineType
    from muvee.testing import testcase, run

    @testcase
    def simple_test():
	      SetActiveMVStyle('S00516_Plain')
	      AddSourceImage('face.jpg')
	      AddSourceMusic('music.mp3')
	      AddSourceVideo('video.avi')
	      AnalyseTillDone()
	      ThreadedMakeTillDone(MakeFlags.MUVEE | MakeFlags.FIT2MUSIC, 30)
	      PreviewTillDone(TimelineType.FINALPREV, 320, 240)

    if __name__ == "__main__":
	      run(simple_test)

Which produces the following output:

    **** Starting: simple_test ****
    >>>>> Generating wrapper for muvee.stubs.Init ...
    unittest.case.FunctionTestCase (Init)
    Initializes MVRuntime.MVCore ...
    ok
    
    ----------------------------------------------------------------------
    Ran 1 test in 1.553s
    
    OK
    >>>>> Generating wrapper for muvee.stubs.SetActiveMVStyle ...
    unittest.case.FunctionTestCase (SetActiveMVStyle) ... ok
    
    ----------------------------------------------------------------------
    Ran 1 test in 0.057s
    
    OK
    
    >>>>> Generating wrapper for muvee.stubs.AddSourceImage ...
    unittest.case.FunctionTestCase (AddSourceImage) ... ok
    
    ----------------------------------------------------------------------
    Ran 1 test in 0.047s
    
    OK
    ..... (truncated)
    2016-06-05 14:45:08		MVUT DETAILS: Passes 8, Failures 0, Untested 0

If due to a code regression any of the steps would fail, the log file also records debug output from the SDK's stdout, which simplifies troubleshooting for developers.

## LICENSE

    Copyright 2016 Muvee Technologies Pte Ltd

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
